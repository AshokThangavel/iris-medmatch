<div class="app-container">
    <div class="top-nav">
        <div class="brand">
            <h1>MedMatch AI <span class="badge">Condition Search</span></h1>
        </div>

        <div class="search-box-compact">
            <div class="input-group">
                <input type="text" [(ngModel)]="searchTerm" (keyup.enter)="onSearch()"
                    placeholder="symptoms (e.g., back pain, Type 2 Diabetes, chronic pain, hypertension)..."
                    [disabled]="loading">
                <button class="btn-search" (click)="onSearch()" [disabled]="loading || !searchTerm">
                    <span *ngIf="!loading">Analyze</span>
                    <span *ngIf="loading" class="spinner"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="status-bar" *ngIf="statusMessage">
        <p [class.error]="statusMessage.includes('failed')">{{ statusMessage }}</p>
    </div>

    <div class="results-card" *ngIf="allResults.length > 0">
        <div class="card-header">
            <div class="header-main">
                <h2>{{ allResults.length }} Match(es) Found</h2>
                <span class="sub-text">Page {{ currentPage }} of {{ totalPages }}</span>
            </div>
        </div>

        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Patient Name</th>
                        <th>Patient Id</th>
                        <th>condition details</th>
                        <th>Condition Id</th>
                        <th class="text-right">Similarity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let result of paginatedResults">
                        <td><strong>{{ result.patientName }}</strong></td>
                        <td><span class="id-tag">{{ result.patientId }}</span></td>
                        <td><strong>{{ result.conditionText}}</strong></td>
                        <td><span class="id-tag">{{ result.condition }}</span></td>
                        <td class="text-right">
                            <span class="score-pill" [ngClass]="getScoreClass(result.similarity)">
                                {{ (result.similarity * 100).toFixed(1) }}%
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="pagination-controls" *ngIf="totalPages > 1">
            <button class="btn-page" [disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">‹ Prev</button>
            <span class="page-numbers">
                <strong>{{ (currentPage - 1) * pageSize + 1 }}-{{ Math.min(currentPage * pageSize, allResults.length)
                    }}</strong> of {{ allResults.length }}
            </span>
            <button class="btn-page" [disabled]="currentPage === totalPages" (click)="goToPage(currentPage + 1)">Next
                ›</button>
        </div>
    </div>
</div>